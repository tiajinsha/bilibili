import{bb as h,bc as y,bd as c}from"./index.ce3b3605.js";const d=[1,2,4,8,16,32],f=[0,1,2,3,4,5];async function _(n){var e,o;if(n.done)return;h.attach(this.outerObject3d);const{slipperyMaterial:u,defaultMaterial:l,world:r,Body:p,Vec3:a}=await y();if(n.done)return;const i=this.cannonBody=new p({mass:(e=this._mass)!==null&&e!==void 0?e:1,material:this._slippery?u:l,collisionFilterGroup:d[(o=this._physicsGroup)!==null&&o!==void 0?o:0],collisionFilterMask:f.filter(s=>{var t;return!(!((t=this._ignorePhysicsGroups)===null||t===void 0)&&t.includes(s))}).map(s=>d[s]).reduce((s,t)=>s+t,0)});await this.physicsShape(),!n.done&&(this._physics==="2d"&&(i.angularFactor=new a(0,0,1),i.linearFactor=new a(1,1,0)),this._noTumble&&(i.angularFactor=new a(0,0,0)),i.position.copy(this.outerObject3d.position),i.quaternion.copy(this.outerObject3d.quaternion),this.physicsUpdate={},r.addBody(i),c.add(this),n.then(()=>{r.removeBody(i),c.delete(this),this.cannonBody=void 0,this.physicsUpdate=void 0}))}export{_ as default};
